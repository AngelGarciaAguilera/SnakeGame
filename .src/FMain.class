' Gambas class file


Private culebra As Serpiente
Private iPasos As Integer

Public Sub DTablero_KeyPress()

  If (Key.Text = "W" Or Key.Text = "A" Or Key.Text = "S" Or Key.Text = "D") Then 
    
    culebra.cambiarDir(Key.Text)
    
  Else If (Key.Text = "j") Then 
    
    culebra = New Serpiente(200, 200, 2, "W")
    iPasos = 1
    Reloj.Start()
    
  Endif

End

Public Sub Form_KeyPress()

  If (Key.Text = "W" Or Key.Text = "A" Or Key.Text = "S" Or Key.Text = "D") Then 
    
    culebra.cambiarDir(Key.Text)
    
  Else If (Key.Text = "j") Then 
    
    culebra = New Serpiente(200, 200, 2, "W")
    iPasos = 1
    Reloj.Start()
    
  Endif

End

Public Sub BJugar_Click()

  culebra = New Serpiente(200, 200, 2, "W")
  iPasos = 1
  Reloj.Start()

End

Public Sub BPausa_Click()

  
  If Reloj.Enabled = True Then 'Reloj.Enabled = True sucede cuando Reloj.Start()
    Reloj.Stop()
  
  Else If Reloj.Enabled = False And culebra = Null Then 
    Message.Info("No hay serpiente")
    
  Else 
    Reloj.Start()
    
  Endif

End

Public Sub Reloj_Timer()
  
  iPasos = iPasos + 1
  
  If iPasos = 5 Then 
    culebra.crecer()
    iPasos = 1
    LNumpuntos.Text += 10
  Else 
  culebra.moverse()
  Endif 
  
  If culebra.estasMuerta(DTablero) Then 
    Reloj.Stop()
    Message.Info("HAS MUERTO")
    LNumpuntos.Text = 0
  Endif
  
  DTablero.Refresh()

End

Public Sub DTablero_Draw()
  
  If (culebra <> Null) Then 
    
    culebra.pintarse(DTablero)
    
  Endif 

End 
